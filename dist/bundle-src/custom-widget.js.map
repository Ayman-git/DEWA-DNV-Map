{"version":3,"file":"custom-widget.js","sources":["ng://ddm-widget/demo-widget/demo-widget-config.component.ts","ng://ddm-widget/demo-widget/demo-widget.component.ts","ng://ddm-widget/demo-widget/demo-widget.module.ts","ng://ddm-widget/public_api.ts","ng://ddm-widget/custom-widget.ts"],"sourcesContent":["import { Component, Input } from '@angular/core';\r\n\r\n@Component({\r\n    template: ``\r\n})\r\nexport class WidgetConfigDemo {\r\n    @Input() config: any = {};\r\n}","import { Component, Input, OnInit } from '@angular/core';\r\nimport { InventoryService } from '@c8y/ngx-components/api';\r\nimport {EventService, OperationService} from '@c8y/ngx-components/api';\r\nimport { AlertService } from '@c8y/ngx-components';\r\nimport * as L from 'leaflet';\r\nimport {IManagedObject} from \"@c8y/client/lib/src/inventory/IManagedObject\";\r\n\r\n@Component({\r\n    templateUrl: './demo-widget.component.html',\r\n    styles: [ `../styles/index.css` ]\r\n})\r\nexport class WidgetDemo implements OnInit{\r\n\r\n\r\n    @Input() config;\r\n\r\n    public mymap: L.map = null;\r\n    public popupstring =  \"<div class=\\\"card\\\" style=\\\"width: 200px; background-color: white;\\\"><img src=\\\"https://img.icons8.com/ios/50/000000/substation.png\\\" class=\\\"card-img-top\\\"style=\\\"width: 200px; height:100px\\\"><div class=\\\"card-body\\\"><br><h4 class=\\\"card-title\\\"></h4><hr style = \\\"margin-top: 2px; margin-bottom: 2px;\\\"><dl><dt>LM</dt><dd >8400</dd><hr style = \\\"margin-top: 2px; margin-bottom: 2px;\\\"><dt >Installation date</dt><dd class=>15 Jan 2020</dd><hr style = \\\"margin-top: 2px; margin-bottom: 2px;\\\"><dt>Running hours</dt><dd>482</dd><hr style = \\\"margin-top: 2px; margin-bottom: 2px;\\\"><dt translate=\\\"\\\">Status</dt><dd><span class = \\\"text-success\\\"> Active </span></dd><hr style = \\\"margin-top: 2px; margin-bottom: 2px;\\\"><a href = \\\"#\\\" class=\\\"card-link\\\">Request Maintenance</a></dl></div></div>\";\r\n    public  device_markers = {}\r\n    public devices: IManagedObject[] = []\r\n    \r\n    \r\n\r\n    public green_icon: L.icon = L.icon({\r\n        iconUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAPCAMAAAA1b9QjAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAMlQTFRFAAAAAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhDAHhD0AtUWgAAAEN0Uk5TABCEJwYLReR/HAECKqf+00wNF2jq//maLAM9uOBiFnP1Okm36HgSk/O8ZdL98KH00Wl827FBw/redgmVvjTZ64668gpU0PkAAACSSURBVHicTc7XFoIwFETRGwE7MaJXxYqKghrF3vv/f5SGZEHO417zMAAykjFM0LOyuXyhqEGpbNMKq2ri1OrYaLZScNsditjtkUT6Aw//2UNXgTkaC0B/MlViBGEsdMaUzBc8FlwGjpysIgnI1xvxydruqBKM9uLB4XjCpPPlCuTmp4De/QHsyTXB1xs+oQ7Ivz9BtRFuDMkS8QAAAABJRU5ErkJggg==',\r\n        \r\n    })\r\n\r\n    public red_icon: L.icon = L.icon({\r\n    iconUrl: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAPCAMAAAA1b9QjAAAAAXNSR0IB2cksfwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAN5QTFRFAAAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA/wAA9PpplAAAAEp0Uk5TAAMYBy6lNAkCH4LsiiIOT9L/11QQLJX6/JwwX9rfZBI4ovupPRN66u6BSbj9vlAejugjBFvGzGMFJ+3vLQZz3OB8CBy5R5mqmk5Ohx5FAAAAlUlEQVR4nFXMaReBUBSF4XMzRcIhucYklCFknufx//8hpVr3ej8+a68N4EcEAn9ForF4ggcxmZLSsshJJpvDfEHhJkW1hLRcYVdKtYaI9YYWAmnqLVeo0Q5Hna6JXlZPCKQ/oD8Z2iMfxhMH/SR16sFsvqCB0OVq7cpG32LYztgDHI4nZJ0vV7jdHYtl2jI8ni++9+cL8zcUfiF5cpMAAAAASUVORK5CYII=',\r\n    \r\n})\r\n\r\n\r\n\r\n\r\n    public myIcon: L.icon = null;\r\n    constructor(\r\n      \r\n        private eventService: EventService,\r\n        private operationService: OperationService,\r\n        private alert: AlertService,\r\n        private inventoryService: InventoryService\r\n\r\n        ) {}\r\n\r\n    ngOnInit(): void {\r\n    \r\n        \r\n\r\n        this.mymap = L.map('mapid').setView([24.760698, 55.366582], 15);\r\n\r\n        console.log('I am here')\r\n\r\n        L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {\r\n            attribution: 'Map data &copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors, Imagery © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\r\n            maxZoom: 18,\r\n            id: 'mapbox/streets-v11',\r\n            tileSize: 512,\r\n            zoomOffset: -1,\r\n            accessToken: 'sk.eyJ1IjoiY2V3OTc2NSIsImEiOiJja3N1aGpvZHIwMjloMm9wdDh2ZnNkbWtiIn0.kmUh2ED3rl3LQAygquxr3w'\r\n        }).addTo(this.mymap);\r\n\r\n               \r\n        let i = 0;\r\n        let substation_locations: number[][] = [\r\n            [24.758008,55.362967],\r\n            [24.759733, 55.361875],\r\n            [24.767669, 55.369639],\r\n            [24.761822, 55.363267],\r\n            [24.761786, 55.363214]\r\n        ]\r\n        \r\n        let location_names: string[] = [\r\n            \"PK11939A\",\r\n            \"PK15326A\",\r\n            \"PK15018A\",\r\n            \"PK15292A\",\r\n            \"PK15324A\"\r\n            \r\n        ]\r\n        let alarms: string[] = [\r\n            \"\",\r\n            \"critical\",\r\n            \"\",\r\n            \"\",\r\n            \"\"\r\n        ]\r\n        let alarms_num: number[] = [\r\n            0,\r\n            2,\r\n            0,\r\n            0,\r\n            0\r\n        ]\r\n        let feeders_num: number[] =[\r\n            5,\r\n            5,\r\n            5,\r\n            6,\r\n            7\r\n        ]\r\n\r\n       \r\n        let url: string[] =[\r\n            `https://dewa.eu-latest.cumulocity.com/apps/app-builder/index.html#/application/57646/dashboard/405287/device/21250`,\r\n            `https://dewa.eu-latest.cumulocity.com/apps/app-builder/index.html#/application/57646/dashboard/822600`,\r\n            `https://dewa.eu-latest.cumulocity.com/apps/app-builder/index.html#/application/57646/dashboard/823524`,\r\n            `https://dewa.eu-latest.cumulocity.com/apps/app-builder/index.html#/application/57646/dashboard/821765`,\r\n            `https://dewa.eu-latest.cumulocity.com/apps/app-builder/index.html#/application/57646/dashboard/822603`\r\n\r\n           ]\r\n\r\n        for (i=0; i<substation_locations.length; i++)\r\n        {\r\n            \r\n            \r\n\r\n           \r\n            \r\n            if(alarms[i] == \"\"){\r\n                \r\n                this.myIcon = this.green_icon;\r\n            }\r\n\r\n            \r\n            else if(alarms[i] == \"critical\"){\r\n                \r\n                this.myIcon = this.red_icon;\r\n                \r\n\r\n            }\r\n\r\n\r\n\r\n            this.myIcon.options.iconSize = [\"10px\", \"10px\"];\r\n             \r\n \r\n            let marker = L.marker([substation_locations[i][0], substation_locations[i][1]],  {icon: this.myIcon})\r\n                     \r\n            let ppstring =  `<div class=\\\"card\\\" style=\\\"width: 150px; background-color: white; color: black;\\\">             \r\n            <div class=\\\"card-body\\\"><br><h4 class=\\\"card-title\\\"></h4> \r\n                <hr style = \\\"margin-top: 2px; margin-bottom: 2px;\\\"> \r\n                <dl>\r\n                    <dt>Name</dt>\r\n                    <dd> `+location_names[i]+` </dd>\r\n                    <hr style = \\\"margin-top: 2px; margin-bottom: 2px;\\\">                                                             \r\n                    <hr style = \\\"margin-top: 2px; margin-bottom: 2px;\\\">\r\n                    <dt translate=\\\"\\\">Active Alarms</dt>\r\n                    <dd><span class = \\\"text-warning\\\">` + alarms_num[i] + `</span></dd>\r\n                    <dt translate=\\\"\\\">Number of feeders</dt>\r\n                    <dd><span class = \\\"text-warning\\\">` + feeders_num[i] + `</span></dd>\r\n                    <hr style = \\\"margin-top: 2px; margin-bottom: 2px;\\\">\r\n                    <a href = \\\"`+ url[i] +`\\\" class=\\\"card-link\\\">Access Dashboard</a>\r\n                </dl></div></div>`;\r\n\r\n            marker.addTo(this.mymap);\r\n\r\n            marker.bindPopup(ppstring);\r\n        }\r\n        \r\n    \r\n    };\r\n}\r\n\r\n\r\n","import {CoreModule, HOOK_COMPONENTS} from \"@c8y/ngx-components\";\r\nimport {WidgetConfigDemo} from \"./demo-widget-config.component\";\r\nimport {WidgetDemo} from \"./demo-widget.component\";\r\nimport {NgModule} from \"@angular/core\";\r\n\r\n// This will import css from the styles folder (Note: will be applied globally, not scoped to the module/components)\r\nimport '~styles/index.css';\r\n\r\n// You can also import css from a module\r\n// import 'some-module/styles.css'\r\n\r\n@NgModule({\r\n    imports: [\r\n        CoreModule\r\n    ],\r\n    declarations: [WidgetDemo, WidgetConfigDemo],\r\n    entryComponents: [WidgetDemo, WidgetConfigDemo],\r\n    providers: [\r\n        // Connect the widget to Cumulocity via the HOOK_COMPONENT injection token\r\n        {\r\n            provide: HOOK_COMPONENTS,\r\n            multi: true,\r\n            useValue: {\r\n                id: 'acme.ddm.widget',\r\n                label: 'Drill Down Map',\r\n                description: 'Displays a Drill Down View',\r\n                component: WidgetDemo,\r\n                configComponent: WidgetConfigDemo,\r\n                previewImage: require(\"~styles/previewImage.png\"),\r\n                // data: {\r\n                //     settings: {\r\n                //         noDeviceTarget: true\r\n                //     }\r\n                // }\r\n            }\r\n        }\r\n    ],\r\n})\r\nexport class DemoWidgetModule {}\r\n","/* Add your widget's module(s) here */\r\n\r\nexport {DemoWidgetModule} from \"./demo-widget/demo-widget.module\";\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n\nexport {WidgetConfigDemo as ɵb} from './demo-widget/demo-widget-config.component';\nexport {WidgetDemo as ɵa} from './demo-widget/demo-widget.component';"],"names":["tslib_1.__decorate","L.icon","L.map","L.tileLayer","marker","L.marker","require$$0"],"mappings":"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"}